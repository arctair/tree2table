plugins {
  id 'groovy'
}

group 'org.example'
version '1.0-SNAPSHOT'

repositories {
  mavenCentral()
}

dependencies {
  implementation(
    'org.codehaus.groovy:groovy-all:+'
  )
  testImplementation(
    'org.spockframework:spock-core:+',
    'junit:junit:4.12',
  )
}

test {
  useJUnitPlatform()
}

configurations {
  metadataRulesConfig {
    resolutionStrategy {
      componentSelection {
        all { ComponentSelection selection ->
          if (selection.getDescriptor(IvyModuleDescriptor)?.branch != "release" && selection.metadata?.status != 'milestone') {
            selection.reject("must have testing branch or milestone status")
          }
        }
      }
    }
  }
}
